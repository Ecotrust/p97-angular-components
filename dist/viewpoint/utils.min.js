String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")},String.prototype.toDash=function(){var e=this[0].toLowerCase()+this.substring(1);return e.replace(/([A-Z])/g,function(e){return"-"+e.toLowerCase()})},String.prototype.toCamel=function(){return this.replace(/(\-[a-z])/g,function(e){return e.toUpperCase().replace("-","")})},window.isLoggedIn=function(e,t){var o=t.user;o&&void 0!==o.token&&e.go("home")},window.hasToken=function(e,t){var o=t.user;return o&&void 0!==o.token?void 0:void e.path("/login")},window.DB=function(e){var t=this;return this.db,this.user,this.users,this.dbFilename=e,this.loadHandler=function(){console.log("[DB.loadHandler]"),t.users=t.db.getCollection("user"),t.users&&t.users.data.length>0&&t.users.data[0].username?t.user=t.users.data[0]:(console.log("[loadDatabase] Could not find users collection"),t._createDb()),console.log("[DB.loadHandler] About to bootstrap angular"),angular.bootstrap(document,[ANGULAR_APPNAME])},this._createDb=function(){var e,o=["user","app","formstack","fsResp","formResp","blockResp","answer","media","statusTable","lastSavedUrl"];_.each(o,function(o){console.log("[createDb] Creating table "+o),e=t.db.addCollection(o),e.setChangesApi(!0)}),t.db.save()},USE_INDEXED_DB===!0?(this.idbAdapter=new lokiIndexedAdapter(t.dbFilename+"-adaptor"),this.db=new loki(t.dbFilename,{adapter:t.idbAdapter,autoload:!0,autoloadCallback:t.loadHandler})):this.db=new loki(t.dbFilename,{persistenceMethod:"localStorage"}),t};