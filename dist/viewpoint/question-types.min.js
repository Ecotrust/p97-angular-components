angular.module("p97.questionTypes",["monospaced.elastic","google.places"]),angular.module("p97.questionTypes").directive("qtLoader",function(e){return{restrict:"E",scope:{questions:"="},template:"<div class='row blocks'></div>",controller:function(t,o){t.addDirectives=function(){_.each(t.questions,function(r,n){r.form={show:!0},"undefined"==typeof r.value&&(r.value="");var l='<div class="question '+r.type+'" '+r.type+' question="questions['+n+']" value="questions['+n+'].value" control="questions['+n+'].form" ng-show="questions['+n+'].form.show"></div>',a=e(l)(t);o.parent().append(a)})},t.addDirectives()}}}),angular.module("p97.questionTypes").directive("datetime",["$http","$templateCache","$compile","$sce",function(e,t,o,r){return{template:"",restrict:"EA",scope:{question:"=",value:"=",control:"="},link:function(n,l){if(n.question){var a=n.question.options;n.errors=[],n.getContentUrl=function(){return n.question.options.widget?BASE_TEMPLATE_URL+"datetime/templates/"+n.question.options.widget+".html":BASE_TEMPLATE_URL+"datetime/templates/"+platform+"/datetime.html"},n.renderHtml=function(e){return r.trustAsHtml(e)},n.internalControl=n.control||{},n.internalControl.validate_answer=function(){n.errors=[];var e=a.datejs_format||"MM/dd/yyyy HH:mm:ss",t=Date.parseExact(n.value,e);return a.required===!0?((null===t||isNaN(t))&&n.errors.push("Invalid format."),0===n.value.length&&n.errors.push("This field is required")):n.value.length>0&&(null===t||0/0===t)&&n.errors.push("Invalid format."),0===n.errors.length},n.internalControl.clean_answer=function(){},e.get(n.getContentUrl(),{cache:t}).success(function(e){var t=l.html(e).contents();o(t)(n)})}}}}]),angular.module("p97.questionTypes").directive("number",["$http","$templateCache","$compile","$sce",function(e,t,o,r){return{template:"",restrict:"EA",scope:{question:"=",value:"=",control:"="},link:function(n,l){if(n.question){var a;isNumber=function(e){return""===e?!1:!isNaN(e)},n.setBlock=function(){a=n.question.options,n.errors=[],n.value=n.question.value,n.dummyValue=n.value},n.setBlock(),n.getContentUrl=function(){return n.question.options.widget?BASE_TEMPLATE_URL+"number/templates/"+n.question.options.widget+".html":BASE_TEMPLATE_URL+"number/templates/"+platform+"/number.html"},n.renderHtml=function(e){return r.trustAsHtml(e)},n.internalControl=n.control||{},n.internalControl.validate_answer=function(){if(n.errors=[],(!isNumber(n.value)||null==n.value)&&a.required&&a.required===!0)return n.errors.push("input must be a number"),!1;if(null!==n.value&&void 0!==n.value){if(!(""===n.value||isNumber(n.value)||a.required&&a.required!==!1))return n.errors.push("input must be a number"),!1;a.min&&isNumber(a.min)&&n.value<a.min&&n.errors.push("value must not be less than "+a.min),a.max&&isNumber(a.max)&&n.value>a.max&&n.errors.push("value must not be more than "+a.max)}return 0===n.errors.length},n.internalControl.clean_answer=function(){},n.$watch("dummyValue",function(e){n.value=isNumber(e)?parseFloat(e):e?e:""}),e.get(n.getContentUrl(),{cache:t}).success(function(e){var t=l.html(e).contents();o(t)(n)}),n.$on("reset-block",function(){console.log("[number] reset-block"),n.setBlock()})}}}}]),angular.module("p97.questionTypes").directive("textarea",["$http","$templateCache","$compile","$sce",function(e,t,o,r){return{template:"",restrict:"EA",scope:{question:"=",value:"=",control:"="},link:function(n,l){if(n.getContentUrl=function(){return n.question.options.widget?BASE_TEMPLATE_URL+"textarea/templates/"+n.question.options.widget+".html":BASE_TEMPLATE_URL+"textarea/templates/"+platform+"/textarea.html"},n.renderHtml=function(e){return r.trustAsHtml(e)},n.question){var a=n.question.options;n.errors=[],n.char_count=0,n.word_count=0,n.internalControl=n.control||{},n.internalControl.validate_answer=function(){if(n.errors=[],null===n.value&&(n.value=""),a.min_word&&n.word_count<a.min_word&&n.errors.push("You must have at least "+a.min_word+" words. You have "+n.word_count),a.max_word){var e=a.max_count||500;n.word_count>e?n.errors.push("You can have up to "+e+" words. You currently have "+n.word_count):n.word_count>a.max_word&&n.errors.push("You can only have "+a.max_word+" words. You have "+n.word_count)}return!a.min_word&&a.min_char&&n.char_count<a.min_char&&n.errors.push("You must have at least "+a.min_char+" characters. You have "+n.char_count),!a.max_word&&a.max_char&&n.char_count>a.max_char&&n.errors.push("You can only have "+a.max_char+" characters. You have "+n.char_count),0===n.errors.length},n.internalControl.clean_answer=function(){},n.$watch("value",function(e){if(e){var t,o=e.length;t=0===o?0:n.value.split(" ").length||0,n.char_count=o,n.word_count=t}}),e.get(n.getContentUrl(),{cache:t}).success(function(e){var t=l.html(e).contents();o(t)(n)})}}}}]),angular.module("p97.questionTypes").directive("yesNo",["$http","$templateCache","$compile","$sce",function(e,t,o,r){return{template:"",restrict:"EA",scope:{question:"=",value:"=",control:"="},link:function(n,l){if(n.getContentUrl=function(){return n.question.options.widget?BASE_TEMPLATE_URL+"yes-no/templates/"+n.question.options.widget+".html":BASE_TEMPLATE_URL+"yes-no/templates/"+platform+"/yes-no.html"},n.renderHtml=function(e){return r.trustAsHtml(e)},n.question){var a=n.question.options;n.errors=[],n.internalControl=n.control||{},n.internalControl.validate_answer=function(){n.errors=[],a.required&&a.required===!0&&null===n.value&&n.errors.push("This field is required")},n.internalControl.clean_answer=function(){null===n.value&&(n.value=!1)},e.get(n.getContentUrl(),{cache:t}).success(function(e){var t=l.html(e).contents();o(t)(n)})}}}}]),angular.module("p97.questionTypes").directive("singleSelect",["$http","$templateCache","$compile","$injector","$sce",function(e,t,o,r,n){if(r.has("$ionicPopup"))var l=r.get("$ionicPopup");if(r.has("$modal"))var a=r.get("$modal");return{template:"",restrict:"EA",scope:{question:"=",value:"=",control:"="},link:function(r,u){if(r.question){var i=/^[A-Za-z\d() _.,-]*$/,s=r.question.options;r.setBlock=function(){if(r.errors=[],r.localChoices=angular.copy(r.question.choices),r.obj={otherValue:null},1===r.question.choices.length&&(r.value=r.question.choices[0].value),s.allow_other>0){var e={verbose:"Other",value:"other"};r.localChoices.push(e)}},r.setBlock(),r.getContentUrl=function(){return r.question.options.widget?BASE_TEMPLATE_URL+"single-select/templates/"+r.question.options.widget+".html":BASE_TEMPLATE_URL+"single-select/templates/"+platform+"/checkbox-single.html"},r.renderHtml=function(e){return n.trustAsHtml(e)},r.changeSelected=function(e){_.each(r.localChoices,function(t){t!==e?t.checked=!1:r.inputValue=t.checked===!0?t.value:""})},r.checkPreviousAnswer=function(){if(r.value&&""!==r.value){if(choiceValues=_.pluck(r.localChoices,"value"),!_.contains(choiceValues,r.value)){var e={verbose:"User Entered: "+r.value,value:r.value};r.localChoices.splice(r.localChoices.length-1,0,e)}r.inputValue=r.value;var t=_.find(r.localChoices,{value:r.inputValue});t.checked=!0}},r.internalControl=r.control||{},r.internalControl.validate_answer=function(){return r.errors=[],s.required&&s.required===!0&&null===r.value&&r.errors.push("This field is required"),i.test(r.value)||r.errors.push("Your 'Other' input is invalid. Please try again without using special characters or symbols"),"other"===r.inputValue&&(r.otherValue&&null!==r.otherValue||r.errors.push("You selected 'Other'. It cannot be blank. Please fill in a response or select another choice")),0===r.errors.length},r.internalControl.clean_answer=function(){},r.otherInputModal=function(){if("hybrid"===platform){l.show({template:'<input type="text" ng-model="obj.otherValue">',title:"Other Option",scope:r,subTitle:"Please enter your input below",buttons:[{text:"Cancel",onTap:function(){r.cancelOther()}},{text:"<b>Confirm</b>",type:"button-positive",onTap:function(){r.confirmModalOtherValue()}}]})}"web"===platform&&(r.myOtherModal=a({scope:r,template:"templates/web/partials/other-input-modal.html",show:!0}))},e.get(r.getContentUrl(),{cache:t}).success(function(e){var t=u.html(e).contents();o(t)(r)}),r.$watch("inputValue",function(e){"other"===e?r.otherInputModal():r.value=e}),r.confirmModalOtherValue=function(){if(0==r.otherValueCheck())return!1;_.each(r.localChoices,function(e){return"User Entered:"===e.verbose.substring(0,13)&&(r.localChoices=_.reject(r.localChoices,e)),r.localChoices});var e={verbose:"User Entered: "+r.obj.otherValue,value:r.obj.otherValue,checked:!0};r.localChoices.splice(r.localChoices.length-1,0,e),r.localChoices[r.localChoices.length-1].checked=!1,r.inputValue=r.obj.otherValue,r.obj.otherValue=""},r.otherValueCheck=function(){if(r.errorEmpty=!1,r.errorDuplicate=!1,r.errorLength=!1,null===r.obj.otherValue||""===r.obj.otherValue)return"hybrid"===platform&&l.alert({title:"No Entry Made",template:"No entry has been made. Please try again or click Cancel."}),"web"===platform&&(r.errorEmpty=!0),r.cancelOther(),!1;if(r.obj.otherValue.length>0){if(localContains=_.some(r.localChoices,function(e){return e.value==r.obj.otherValue}))return r.errorDuplicate=!1,"hybrid"===platform&&l.alert({title:"Duplicate Entries",template:"You have typed a duplicate answer. Please try again."}),"web"===platform&&(r.errorDuplicate=!0),r.obj.otherValue="",r.cancelOther(),!1;if(r.obj.otherValue.length>s.other_max_length)return"hybrid"===platform&&l.alert({title:"Too long",template:"You have typed an answer that is too long. Please try again."}),"web"===platform&&(r.errorLength=!0),r.cancelOther(),!1;r.closeModal=function(){"web"===platform&&r.errorLength===!1&&r.errorDuplicate===!1&&r.errorEmpty===!1&&r.myOtherModal.$promise.then(r.myOtherModal.hide)}}},r.cancelOther=function(){r.localChoices[r.localChoices.length-1].checked=!1,r.inputValue=""},r.checkPreviousAnswer(),r.$on("reset-block",function(){console.log("[single-select] reset-block"),r.setBlock(),r.value=r.question.value,r.checkPreviousAnswer()})}}}}]),angular.module("p97.questionTypes").directive("text",["$http","$templateCache","$compile","$sce",function(e,t,o,r){return{template:"",restrict:"EA",scope:{question:"=",value:"=",control:"="},link:function(n,l){if(n.getContentUrl=function(){return n.question.options.widget?BASE_TEMPLATE_URL+"text/templates/"+n.question.options.widget+".html":BASE_TEMPLATE_URL+"text/templates/"+platform+"/text.html"},n.renderHtml=function(e){return r.trustAsHtml(e)},n.question){var a=n.question.options;n.errors=[],n.char_count=0,n.word_count=0,n.internalControl=n.control||{},n.internalControl.validate_answer=function(){if(n.errors=[],null===n.value&&(n.value=""),a.min_word&&n.word_count<a.min_word&&n.errors.push("You must have at least "+a.min_word+" words. You have "+n.word_count),a.max_word){var e=a.max_count||20;n.word_count>e?n.errors.push("You can have up to "+e+" words. You currently have "+n.word_count):n.word_count>a.max_word&&n.errors.push("You can only have "+a.max_word+" words. You have "+n.word_count)}return!a.min_word&&a.min_char&&n.char_count<a.min_char&&n.errors.push("You must have at least "+a.min_char+" characters. You have "+n.char_count),!a.max_word&&a.max_char&&n.char_count>a.max_char&&n.errors.push("You can only have "+a.max_char+" characters. You have "+n.char_count),0===n.errors.length},n.internalControl.clean_answer=function(){},n.$watch("value",function(e){if(e){var t,o=e.length;t=0===o?0:n.value.split(" ").length||0,n.char_count=o,n.word_count=t}}),e.get(n.getContentUrl(),{cache:t}).success(function(e){var t=l.html(e).contents();o(t)(n)})}}}}]),angular.module("p97.questionTypes").directive("integer",["$http","$templateCache","$compile","$sce",function(e,t,o,r){return{template:"",restrict:"EA",scope:{question:"=",value:"=",control:"="},link:function(n,l){if(n.question){var a;isInteger=function(e){return""===e?!1:(y=parseInt(e,10),"number"==typeof y&&e%1===0)},n.setBlock=function(){a=n.question.options,n.errors=[],n.value=n.question.value,n.dummyValue=n.value},n.setBlock(),n.getContentUrl=function(){return n.question.options.widget?BASE_TEMPLATE_URL+"integer/templates/"+n.question.options.widget+".html":BASE_TEMPLATE_URL+"integer/templates/"+platform+"/integer.html"},n.renderHtml=function(e){return r.trustAsHtml(e)},n.internalControl=n.control||{},n.internalControl.validate_answer=function(){if(n.errors=[],(!isInteger(n.value)||null==n.value)&&a.required&&a.required===!0)return n.errors.push("input must be a integer"),!1;if(null!==n.value&&void 0!==n.value){if(!(""===n.value||isInteger(n.value)||a.required&&a.required!==!1))return n.errors.push("input must be a integer"),!1;a.min&&isInteger(a.min)&&n.value<a.min&&n.errors.push("value must not be less than "+a.min),a.max&&isInteger(a.max)&&n.value>a.max&&n.errors.push("value must not be more than "+a.max)}return 0===n.errors.length},n.internalControl.clean_answer=function(){},n.$watch("dummyValue",function(e){n.value=isInteger(e)?parseInt(e):e?e:""}),e.get(n.getContentUrl(),{cache:t}).success(function(e){var t=l.html(e).contents();o(t)(n)}),n.$on("reset-block",function(){console.log("[integer] reset-block"),n.setBlock()})}}}}]),angular.module("p97.questionTypes").directive("email",["$http","$templateCache","$compile","$sce",function(e,t,o,r){return{template:"",restrict:"EA",scope:{question:"=",value:"=",control:"="},link:function(n,l){if(n.question){var a=n.question.options;n.errors=[],n.getContentUrl=function(){return n.question.options.widget?BASE_TEMPLATE_URL+"email/templates/"+n.question.options.widget+".html":BASE_TEMPLATE_URL+"email/templates/"+platform+"/email.html"},n.renderHtml=function(e){return r.trustAsHtml(e)},n.internalControl=n.control||{},n.internalControl.validate_answer=function(){n.errors=[];var e=/^[_a-z0-9-]+(\.[_a-z0-9-]+)*@[a-z0-9-]+(\.[a-z0-9-]+)*(\.[a-z]{2,4})$/;return!e.test(n.value)&&a.required&&a.required===!0?(n.errors.push("input must be a valid email"),!1):e.test(n.value)||a.required&&a.required!==!1?0===n.errors.length:(n.errors.push("input must be a valid email"),!1)},n.internalControl.clean_answer=function(){},e.get(n.getContentUrl(),{cache:t}).success(function(e){var t=l.html(e).contents();o(t)(n)})}}}}]),angular.module("p97.questionTypes").directive("date",["$http","$templateCache","$compile","$sce",function(e,t,o,r){return{template:"",restrict:"EA",scope:{question:"=",value:"=",control:"="},link:function(n,l){if(n.question){var a=n.question.options,u=/^(19|20)\d{2}$/;n.errors=[],n.getContentUrl=function(){return n.question.options.widget?BASE_TEMPLATE_URL+"date/templates/"+n.question.options.widget+".html":BASE_TEMPLATE_URL+"date/templates/"+platform+"/date.html"},n.renderHtml=function(e){return r.trustAsHtml(e)},n.internalControl=n.control||{},n.internalControl.validate_answer=function(){n.errors=[];var e=a.format;if(convertToDate=function(e){return new Date(e)},a&&a.required===!0&&(null==n.value||""==n.value||void 0==n.value))return n.errors.push("Invalid date format"),!1;if("yyyy"!==e){if(null!==n.value||""!==n.value){if(void 0==n.value)return n.errors.push("Invalid date format"),!1;a.min&&convertToDate(n.value)<convertToDate(a.min)&&n.errors.push("Your selected date is too low"),a.max&&convertToDate(n.value)>convertToDate(a.max)&&n.errors.push("Your selected date is too high")}}else null!==n.value&&void 0!==n.value&&n.value.length>0&&(u.test(n.value)||n.errors.push("Input must be a valid year"),a.min&&u.test(a.min)&&n.value<a.min&&n.errors.push("Year must not be lower than "+a.min),a.max&&u.test(a.max)&&n.value>a.max&&n.errors.push("Year must not be higher than "+a.max));return 0===n.errors.length},n.internalControl.clean_answer=function(){},e.get(n.getContentUrl(),{cache:t}).success(function(e){var t=l.html(e).contents();o(t)(n)})}}}}]),angular.module("p97.questionTypes").directive("phonenumber",["$http","$templateCache","$compile","$sce",function(e,t,o,r){return{template:"",restrict:"EA",scope:{question:"=",value:"=",control:"="},link:function(n,l){if(n.question){var a=n.question.options;n.errors=[];var u=/^\(?([0-9]{3})\)?[-. ]?([0-9]{3})[-. ]?([0-9]{4})$/,i=/^[0-9 ]+$/;n.getContentUrl=function(){return n.question.options.widget?BASE_TEMPLATE_URL+"phonenumber/templates/"+n.question.options.widget+".html":BASE_TEMPLATE_URL+"phonenumber/templates/"+platform+"/phonenumber.html"},n.renderHtml=function(e){return r.trustAsHtml(e)},n.internalControl=n.control||{},n.internalControl.validate_answer=function(){n.errors=[];a.default||"North America";return a.required&&a.required===!0&&null===n.value?(n.errors.push("This field is required"),!1):(a.format&&"North America"===a.format&&(u.test(n.value)||n.errors.push("input must be a valid North America phonenumber")),a.format&&"International"===a.format&&(i.test(n.value)||n.errors.push("input must be a valid International phonenumber")),0===n.errors.length)},n.internalControl.parse_phone=function(){if(a.format&&"North America"===a.format&&u.test(n.value)){var e="+"+a.country+" "+n.value.replace(u,"$1 $2$3");n.parsed_array=e.split(" ")}if(a.format&&"International"===a.format&&i.test(n.value)){var e="+"+a.country+" "+n.value;n.parsed_array=e.split(" ")}return n.parsed_array},n.internalControl.clean_answer=function(){return n.internalControl.cleaned_value=n.internalControl.parse_phone(),n.internalControl.cleaned_value},e.get(n.getContentUrl(),{cache:t}).success(function(e){var t=l.html(e).contents();o(t)(n)})}}}}]),angular.module("p97.questionTypes").directive("multiSelect",["$http","$templateCache","$compile","$injector","$sce",function(e,t,o,r,n){if(r.has("$ionicPopup"))var l=r.get("$ionicPopup");if(r.has("$modal"))var a=r.get("$modal");return{template:"",restrict:"EA",scope:{question:"=",value:"=",control:"="},link:function(r,u){if(r.question){var i=r.question.options,s=/^[A-Za-z\d() _.,-]*$/;r.setBlock=function(){if(r.showOtherInput=!1,r.choicesSelected=0,r.errors=[],r.valueArray=[],r.obj={otherValue:null},r.localChoices=angular.copy(r.question.choices),1===r.question.choices.length&&(r.value=r.question.choices[0].value),i.allow_other>0){var e={verbose:"Other",value:"other"};r.localChoices.push(e)}},r.setBlock(),r.getContentUrl=function(){return r.question.options.widget?BASE_TEMPLATE_URL+"multi-select/templates/"+r.question.options.widget+".html":BASE_TEMPLATE_URL+"multi-select/templates/"+platform+"/checkbox.html"},r.renderHtml=function(e){return n.trustAsHtml(e)},r.resetBlock=function(){r.setBlock(),r.value=r.question.value,r.togglePrevAnswers()},r.internalControl=r.control||{},r.internalControl.validate_answer=function(){return r.errors=[],r.choicesSelected=r.value.length,i.required&&i.required===!0&&0===r.value.length&&r.errors.push("This field is required"),i.max_choice&&r.choicesSelected>i.max_choice&&r.errors.push("You can have up to "+i.max_choice+" choices. You currently have "+r.choicesSelected),i.min_choice&&r.choicesSelected<i.min_choice&&r.errors.push("You need at least "+i.min_choice+" choices. You currently have "+r.choicesSelected),r.value.length>0&&_.each(r.value,function(e){s.test(e)?("other"===e&&!r.otherValue||null===r.otherValue)&&r.errors.push("You selected 'Other'. Please fill in a response or type in another choice"):r.errors.push("Your 'Other' input is invalid. Please try again without using special characters or symbols")}),0===r.errors.length},r.internalControl.clean_answer=function(){},r.addChoicesToArray=function(e){r.value&&""!==r.value&&(r.valueArray=r.value);var t=r.valueArray.indexOf(e);t>-1?r.valueArray.splice(t,1):r.valueArray.push(e),r.valueArray.length>0?r.value=r.valueArray:r.value},r.otherInputModal=function(){if("hybrid"===platform){l.show({template:'<input type="text" ng-model="obj.otherValue">',title:"Other Option",scope:r,subTitle:"Please enter your input below",buttons:[{text:"Cancel",onTap:function(){r.cancelOther()}},{text:"<b>Confirm</b>",type:"button-positive",onTap:function(){r.confirmModalOtherValue()}}]})}"web"===platform&&(r.myOtherModal=a({scope:r,template:"templates/web/partials/other-input-modal.html",show:!0}))},r.confirmModalOtherValue=function(){if(0==r.otherValueCheck())return!1;var e={verbose:"User Entered: "+r.obj.otherValue,value:r.obj.otherValue,checked:!0};r.localChoices.splice(r.localChoices.length-1,0,e),r.value[r.value.indexOf("other")]=r.obj.otherValue,r.localChoices[r.localChoices.length-1].checked=!1,r.obj.otherValue=""},r.otherValueCheck=function(){if(r.errorEmpty=!1,r.errorDuplicate=!1,r.errorLength=!1,null===r.obj.otherValue||""===r.obj.otherValue)return"hybrid"===platform&&l.alert({title:"No Entry Made",template:"No entry has been made. Please try again or click Cancel."}),"web"===platform&&(r.errorEmpty=!0),r.cancelOther(),!1;if(r.obj.otherValue.length>0){if(_.contains(r.value,r.obj.otherValue))return"hybrid"===platform&&l.alert({title:"Duplicate Entries",template:"You have typed a duplicate answer. Please try again."}),"web"===platform&&(r.errorDuplicate=!0),r.obj.otherValue="",r.cancelOther(),!1;if(r.obj.otherValue.length>i.other_max_length)return"hybrid"===platform&&l.alert({title:"Too long",template:"You have typed an answer that is too long. Please try again."}),"web"===platform&&(r.errorLength=!0),r.cancelOther(),!1;r.closeModal=function(){"web"===platform&&r.errorLength===!1&&r.errorDuplicate===!1&&r.errorEmpty===!1&&r.myOtherModal.$promise.then(r.myOtherModal.hide)}}},r.$watch("valueArray",function(e){e&&_.contains(e,"other")&&r.otherInputModal()},!0),r.togglePrevAnswers=function(){_.each(r.localChoices,function(e){e.checked=!1}),_.each(r.value,function(e){if(choiceValues=_.pluck(r.localChoices,"value"),_.contains(choiceValues,e)){var t=_.find(r.localChoices,function(t){return t.value===e});t.checked=!0}else{var o={verbose:"User Entered: "+e,value:e,checked:!0};r.localChoices.splice(r.localChoices.length-1,0,o)}})},r.cancelOther=function(){r.localChoices[r.localChoices.length-1].checked=!1,r.value=_.compact(_.without(r.value,"other")),r.valueArray=_.compact(_.without(r.valueArray,"other"))},r.togglePrevAnswers(),r.$on("reset-block",function(){console.log("[multi-select] reset-block"),r.resetBlock()}),e.get(r.getContentUrl(),{cache:t}).success(function(e){var t=u.html(e).contents();o(t)(r)})}}}}]),angular.module("p97.questionTypes").directive("toggle",["$http","$templateCache","$compile","$sce",function(e,t,o,r){return{template:"",restrict:"EA",scope:{question:"=",value:"=",control:"="},link:function(n,l){if(n.getContentUrl=function(){return n.question.options.widget?BASE_TEMPLATE_URL+"toggle/templates/"+n.question.options.widget+".html":BASE_TEMPLATE_URL+"toggle/templates/"+platform+"/toggle.html"},n.renderHtml=function(e){return r.trustAsHtml(e)},n.question){var a=n.question.options;n.errors=[],"undefined"!=typeof n.question.value&&(n.localValue=n.question.value),n.internalControl=n.control||{},n.internalControl.validate_answer=function(){return n.value===a.choices.positiveValue||n.value===a.choices.negativeValue?!0:void 0},n.internalControl.clean_answer=function(){},n.$watch("localValue",function(e){n.value=e===!0?a.choices.positiveValue||!0:a.choices.negativeValue||!1}),e.get(n.getContentUrl(),{cache:t}).success(function(e){var t=l.html(e).contents();o(t)(n)})}}}}]),angular.module("p97.questionTypes").directive("autocompleteSearch",["$http","$templateCache","$compile","$sce",function(e,t,o,r){return{template:"",restrict:"EA",scope:{question:"=",value:"=",control:"="},link:function(n,l){if(n.getContentUrl=function(){return n.question.options.widget?BASE_TEMPLATE_URL+"autocomplete-search/templates/"+n.question.options.widget+".html":BASE_TEMPLATE_URL+"autocomplete-search/templates/"+platform+"/autocomplete.html"},n.renderHtml=function(e){return r.trustAsHtml(e)},n.question){var a=n.question.options;n.autocompleteOptions={componentRestrictions:{country:"us"},types:[],stateFilter:a.stateRestrict||[]},n.internalControl=n.control||{},n.internalControl.validate_answer=function(){return n.errors=[],null===n.value&&(n.value=""),!a.required||a.required!==!0||0!==n.value.length&&""!==n.value||n.errors.push("This field is required"),0===n.errors.length},n.internalControl.clean_answer=function(){},e.get(n.getContentUrl(),{cache:t}).success(function(e){var t=l.html(e).contents();o(t)(n)})}}}}]),angular.module("p97.questionTypes").directive("info",["$http","$templateCache","$compile","$sce",function(e,t,o,r){return{template:"",restrict:"EA",scope:{question:"=",value:"=",control:"="},link:function(n,l){if(n.getContentUrl=function(){return n.question.options.widget?BASE_TEMPLATE_URL+"info/templates/"+n.question.options.widget+".html":BASE_TEMPLATE_URL+"info/templates/"+platform+"/info.html"},n.renderHtml=function(e){return r.trustAsHtml(e)},n.question){{n.question.options}n.internalControl=n.control||{},n.internalControl.validate_answer=function(){return n.errors=[],null===n.value&&(n.value=""),0===n.errors.length},n.internalControl.clean_answer=function(){},e.get(n.getContentUrl(),{cache:t}).success(function(e){var t=l.html(e).contents();o(t)(n)})}}}}]),angular.module("p97.questionTypes").directive("geojson",["$q","$http","$templateCache","$compile","$timeout","$window","$ionicLoading","$sce",function(e,t,o,r,n,l,a,u){return{template:"",restrict:"EA",scope:{question:"=",value:"=",control:"="},link:function(e,n){if(e.errors=[],e.getContentUrl=function(){return e.question.options.widget?BASE_TEMPLATE_URL+"geojson/templates/"+e.question.options.widget+".html":BASE_TEMPLATE_URL+"geojson/templates/"+platform+"/geojson.html"},e.renderHtml=function(e){return u.trustAsHtml(e)},e.question){{e.question.options}e.internalControl=e.control||{},e.internalControl.validate_answer=function(){if(e.errors=[],out=!0,e.question.options.required===!0)if(0===e.value.length)out=!1,e.errors.push("A location is required.");else{var t=JSON.parse(e.value);0===t.features.length&&(out=!1,e.errors.push("A location is required."))}return out},e.internalControl.clean_answer=function(){},t.get(e.getContentUrl(),{cache:o}).success(function(t){var o=n.html(t).contents();r(o)(e)})}}}}]);