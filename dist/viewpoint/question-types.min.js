angular.module("p97.questionTypes",[]),angular.module("p97.questionTypes").directive("qtLoader",function(e){return{restrict:"E",scope:{questions:"="},template:"<div class='row blocks'></div>",controller:function(t,n){t.addDirectives=function(){_.each(t.questions,function(r,o){r.form={},"undefined"==typeof r.value&&(r.value="");var u="<div "+r.type+' question="questions['+o+']" value="questions['+o+'].value" control="questions['+o+'].form" cid="questions['+o+'].answerCid"></div>',a=e(u)(t);n.parent().append(a)})},t.addDirectives()}}}),angular.module("p97.questionTypes").directive("datetime",function(e,t,n){return{template:"",restrict:"EA",scope:{question:"=",value:"=",control:"="},link:function(r,o){if(r.getContentUrl=function(){return r.question.options.templateUrl?BASE_URL+"datetime/templates/datetime/"+r.question.options.templateUrl+".html":BASE_URL+"datetime/templates/ionic/datetime.html"},r.question){var u=r.question.options;r.errors=[],r.internalControl=r.control||{},r.internalControl.validate_answer=function(){r.errors=[];var e=u.datejs_format||"MM/dd/yyyy",t=Date.parseExact(r.value,e);return u.required===!0?((null===t||isNaN(t))&&r.errors.push("Invalid format."),0===r.value.length&&r.errors.push("This field is required")):r.value.length>0&&(null===t||0/0===t)&&r.errors.push("Invalid format."),0===r.errors.length},r.internalControl.clean_answer=function(){},e.get(r.getContentUrl(),{cache:t}).success(function(e){var t=o.html(e).contents();n(t)(r)})}}}}),angular.module("p97.questionTypes").directive("number",function(e,t,n){return{template:"",restrict:"EA",scope:{question:"=",value:"=",control:"="},link:function(r,o){if(r.getContentUrl=function(){return r.question.options.templateUrl?BASE_URL+"number/templates/number/"+r.question.options.templateUrl+".html":BASE_URL+"number/templates/ionic/number.html"},r.question){var u=r.question.options;r.errors=[],r.internalControl=r.control||{},r.internalControl.validate_answer=function(){return r.errors=[],"number"!=typeof r.value&&u.required&&u.required===!0?(r.errors.push("input must be a number"),!1):"number"==typeof r.value||u.required&&u.required!==!1?(u.min&&"number"==typeof u.min&&r.value<u.min&&r.errors.push("value must not be less than "+u.min),u.max&&r.value>u.max&&r.errors.push("value must not be more than "+u.max),0===r.errors.length):(r.errors.push("input must be a number"),!1)},r.internalControl.clean_answer=function(){r.value=parseFloat(r.value,10)},e.get(r.getContentUrl(),{cache:t}).success(function(e){var t=o.html(e).contents();n(t)(r)})}}}}),angular.module("p97.questionTypes").directive("textarea",function(e,t,n){return{template:"",restrict:"EA",scope:{question:"=",value:"=",control:"="},link:function(r,o){if(r.getContentUrl=function(){return r.question.options.templateUrl?BASE_URL+"textarea/templates/textarea/"+r.question.options.templateUrl+".html":BASE_URL+"textarea/templates/ionic/textarea.html"},r.question){var u=r.question.options;r.errors=[],r.char_count=0,r.word_count=0,r.internalControl=r.control||{},r.internalControl.validate_answer=function(){if(r.errors=[],null===r.value&&(r.value=""),u.min_word&&r.word_count<u.min_word&&r.errors.push("You must have at least "+u.min_word+" words. You have "+r.word_count),u.max_word){var e=u.max_count||500;r.word_count>e?r.errors.push("You can have up to "+e+" words. You currently have "+r.word_count):r.word_count>u.max_word&&r.errors.push("You can only have "+u.max_word+" words. You have "+r.word_count)}return!u.min_word&&u.min_char&&r.char_count<u.min_char&&r.errors.push("You must have at least "+u.min_char+" characters. You have "+r.char_count),!u.max_word&&u.max_char&&r.char_count>u.max_char&&r.errors.push("You can only have "+u.max_char+" characters. You have "+r.char_count),0===r.errors.length},r.internalControl.clean_answer=function(){},r.$watch("value",function(e){if(e){var t,n=e.length;t=0===n?0:r.value.split(" ").length||0,r.char_count=n,r.word_count=t}}),e.get(r.getContentUrl(),{cache:t}).success(function(e){var t=o.html(e).contents();n(t)(r)})}}}}),angular.module("p97.questionTypes").directive("yesNo",function(e,t,n){return{template:"",restrict:"EA",scope:{question:"=",value:"=",control:"="},link:function(r,o){if(r.getContentUrl=function(){return r.question.options.templateUrl?BASE_URL+"yes-no/templates/yes-no/"+r.question.options.templateUrl+".html":BASE_URL+"yes-no/templates/ionic/yes-no.html"},r.question){var u=r.question.options;r.errors=[],r.internalControl=r.control||{},r.internalControl.validate_answer=function(){r.errors=[],u.required&&u.required===!0&&null===r.value&&r.errors.push("This field is required")},r.internalControl.clean_answer=function(){null===r.value&&(r.value=!1)},e.get(r.getContentUrl(),{cache:t}).success(function(e){var t=o.html(e).contents();n(t)(r)})}}}}),angular.module("p97.questionTypes").directive("singleSelect",function(e,t,n){return{template:"",restrict:"EA",scope:{question:"=",value:"=",control:"="},link:function(r,o){if(r.getContentUrl=function(){return r.question.options.templateUrl?BASE_URL+"single-select/templates/single-select/"+r.question.options.templateUrl+".html":BASE_URL+"single-select/templates/ionic/single-select.html"},r.question){var u=r.question.options;r.errors=[],1===r.question.choices.length&&(r.value=r.question.choices[0].value),r.internalControl=r.control||{},r.internalControl.validate_answer=function(){r.errors=[],u.required&&u.required===!0&&null===r.value&&r.errors.push("This field is required")},r.internalControl.clean_answer=function(){null===r.value&&(r.value=!1)},e.get(r.getContentUrl(),{cache:t}).success(function(e){var t=o.html(e).contents();n(t)(r)})}}}}),angular.module("p97.questionTypes").directive("text",function(e,t,n){return{template:"",restrict:"EA",scope:{question:"=",value:"=",control:"="},link:function(r,o){if(r.getContentUrl=function(){return r.question.options.templateUrl?BASE_URL+"text/templates/text/"+r.question.options.templateUrl+".html":BASE_URL+"text/templates/ionic/text.html"},r.question){var u=r.question.options;r.errors=[],r.char_count=0,r.word_count=0,r.internalControl=r.control||{},r.internalControl.validate_answer=function(){if(r.errors=[],null===r.value&&(r.value=""),u.min_word&&r.word_count<u.min_word&&r.errors.push("You must have at least "+u.min_word+" words. You have "+r.word_count),u.max_word){var e=u.max_count||20;r.word_count>e?r.errors.push("You can have up to "+e+" words. You currently have "+r.word_count):r.word_count>u.max_word&&r.errors.push("You can only have "+u.max_word+" words. You have "+r.word_count)}return!u.min_word&&u.min_char&&r.char_count<u.min_char&&r.errors.push("You must have at least "+u.min_char+" characters. You have "+r.char_count),!u.max_word&&u.max_char&&r.char_count>u.max_char&&r.errors.push("You can only have "+u.max_char+" characters. You have "+r.char_count),0===r.errors.length},r.internalControl.clean_answer=function(){},r.$watch("value",function(e){if(e){var t,n=e.length;t=0===n?0:r.value.split(" ").length||0,r.char_count=n,r.word_count=t}}),e.get(r.getContentUrl(),{cache:t}).success(function(e){var t=o.html(e).contents();n(t)(r)})}}}}),angular.module("p97.questionTypes").directive("integer",function(e,t,n){return{template:"",restrict:"EA",scope:{question:"=",value:"=",control:"="},link:function(r,o){if(r.getContentUrl=function(){return r.question.options.templateUrl?BASE_URL+"integer/templates/integer/"+r.question.options.templateUrl+".html":BASE_URL+"integer/templates/ionic/integer.html"},r.question){var u=r.question.options;r.errors=[],r.internalControl=r.control||{},r.internalControl.validate_answer=function(){function e(e){return"number"==typeof e&&e%1===0}return r.errors=[],!e(r.value)&&u.required&&u.required===!0?(r.errors.push("input must be a integer"),!1):e(r.value)||u.required&&u.required!==!1?(u.min&&e(u.min)&&r.value<u.min&&r.errors.push("value must not be less than "+u.min),u.max&&e(u.max)&&r.value>u.max&&r.errors.push("value must not be more than "+u.max),0===r.errors.length):(r.errors.push("input must be a integer"),!1)},r.internalControl.clean_answer=function(){r.value=parseFloat(r.value,10)},e.get(r.getContentUrl(),{cache:t}).success(function(e){var t=o.html(e).contents();n(t)(r)})}}}});